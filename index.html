<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>MOUSE AI | IPTV â€” Regions & Local Save</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{--primary:#00d2ff;--accent:#00ff88;--bg:#03060a;--panel:#0d1117;--muted:#8b949e;--card:#13171b}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Tajawal',sans-serif}
body{background:linear-gradient(#02040a,#05060a);color:#e6edf3;margin:0}
header{height:70px;display:flex;align-items:center;justify-content:space-between;padding:0 18px;background:transparent}
.brand{font-family:'Orbitron';color:var(--primary);font-size:1.4rem}
.status{padding:6px 12px;border-radius:20px;background:rgba(0,255,136,0.06);color:var(--accent);font-weight:700}
main{display:grid;grid-template-columns:380px 1fr;gap:18px;padding:12px 18px;align-items:start}
.sidebar{background:linear-gradient(var(--panel), rgba(255,255,255,0.01));border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;min-height:0}
.controls{display:flex;gap:8px}
.btn{padding:10px;border-radius:8px;background:var(--primary);border:none;color:#000;cursor:pointer;font-weight:700}
.btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
.input{padding:10px;border-radius:8px;background:#000;border:1px solid rgba(255,255,255,0.03);color:#fff;width:100%}
.list{padding:12px;overflow:auto;display:flex;flex-direction:column;gap:10px;min-height:0;max-height:calc(100vh - 320px)}
.channel{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;background:var(--card);border:1px solid rgba(255,255,255,0.02);transition:all .15s;cursor:pointer}
.channel:hover{transform:translateX(-6px);box-shadow:0 6px 18px rgba(0,0,0,0.6);border-color:var(--primary)}
.channel img{width:52px;height:52px;border-radius:8px;object-fit:cover;background:#000;flex-shrink:0}
.meta{flex:1;min-width:0}
.meta b{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.meta small{display:block;color:var(--muted);font-size:0.85rem}
.status-dot{width:12px;height:12px;border-radius:50%;display:inline-block;margin-inline-start:8px}
.status-unknown{background:#777}
.status-alive{background:#2ecc71}
.status-dead{background:#ff4d4d}
.player-card{background:linear-gradient( rgba(255,255,255,0.02), transparent);border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,0.03);position:sticky;top:86px;z-index:20}
.video-wrap{position:relative;border-radius:10px;overflow:hidden;background:#000;height:0;padding-top:56.25%}
.video-wrap video{position:absolute;inset:0;width:100%;height:100%;object-fit:contain}
.toast{position:fixed;left:18px;bottom:18px;background:#0d1117;padding:10px 14px;border-radius:8px;z-index:9999}
.footer{height:48px;display:flex;align-items:center;justify-content:center;color:var(--muted);border-top:1px solid rgba(255,255,255,0.02)}
</style>
</head>
<body>

<header>
  <div style="display:flex;align-items:center;gap:12px">
    <div class="brand"><i class="fa fa-wave-square" style="color:var(--primary)"></i> MOUSE AI</div>
    <div class="small" style="font-size:0.85rem;color:var(--muted)">Ù†Ø¸Ø§Ù… IPTV Ø§Ù„Ø°ÙƒÙŠ â€” Ø§Ù„Ù…Ø·ÙˆØ± MisterAI</div>
  </div>
  <div style="display:flex;align-items:center;gap:10px">
    <div class="status" id="loadStatus">Ø¬Ø§Ù‡Ø²</div>
  </div>
</header>

<main>
  <aside class="sidebar">
    <div class="controls" style="margin-bottom:10px">
      <button class="btn" id="importBtn"><i class="fa fa-file-import"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
      <button class="btn" id="scanBtn" title="ÙØ­Øµ Ø§Ù„Ù‚Ù†ÙˆØ§Øª"><i class="fa fa-microscope"></i> ÙØ­Øµ</button>
      <button class="btn secondary" id="removeDeadBtn"><i class="fa fa-trash"></i> Ø­Ø°Ù Ø§Ù„ØºÙŠØ± Ø´ØºÙ‘Ø§Ù„Ø©</button>
    </div>

    <div style="display:flex;gap:8px;margin-bottom:8px">
      <button class="btn secondary" id="exportBtn"><i class="fa fa-download"></i> ØªØµØ¯ÙŠØ±</button>
      <button class="btn secondary" id="clearBtn"><i class="fa fa-eraser"></i> Ù…Ø³Ø­</button>
    </div>

    <div style="margin-bottom:8px">
      <select id="sourceSelector" class="input">
        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø£Ùˆ Ø§Ù„Ø¯ÙˆÙ„Ø© --</option>
        <optgroup label="Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©">
            <option value="https://iptv-org.github.io/iptv/languages/ara.m3u">ğŸŒ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            <option value="https://iptv-org.github.io/iptv/categories/sports.m3u">âš½ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©</option>
            <option value="https://iptv-org.github.io/iptv/regions/maghreb.m3u">ğŸ‡²ğŸ‡¦ğŸ‡©ğŸ‡¿ Ø§Ù„Ù…ØºØ±Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ</option>
            <option value="https://iptv-org.github.io/iptv/regions/afr.m3u">ğŸŒ Ø£ÙØ±ÙŠÙ‚ÙŠØ§</option>
        </optgroup>
        
        <optgroup label="Ø£ÙØ±ÙŠÙ‚ÙŠØ§ ÙˆØ¢Ø³ÙŠØ§">
            <option value="https://iptv-org.github.io/iptv/countries/dz.m3u">ğŸ‡©ğŸ‡¿ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
            <option value="https://iptv-org.github.io/iptv/countries/eg.m3u">ğŸ‡ªğŸ‡¬ Ù…ØµØ±</option>
            <option value="https://iptv-org.github.io/iptv/countries/ma.m3u">ğŸ‡²ğŸ‡¦ Ø§Ù„Ù…ØºØ±Ø¨</option>
            <option value="https://iptv-org.github.io/iptv/countries/af.m3u">ğŸ‡¦ğŸ‡« Ø£ÙØºØ§Ù†Ø³ØªØ§Ù†</option>
            <option value="https://iptv-org.github.io/iptv/countries/bh.m3u">ğŸ‡§ğŸ‡­ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
            <option value="https://iptv-org.github.io/iptv/countries/iq.m3u">ğŸ‡®ğŸ‡¶ Ø§Ù„Ø¹Ø±Ø§Ù‚</option>
            <option value="https://iptv-org.github.io/iptv/countries/jo.m3u">ğŸ‡¯ğŸ‡´ Ø§Ù„Ø£Ø±Ø¯Ù†</option>
            <option value="https://iptv-org.github.io/iptv/countries/kw.m3u">ğŸ‡°ğŸ‡¼ Ø§Ù„ÙƒÙˆÙŠØª</option>
            <option value="https://iptv-org.github.io/iptv/countries/lb.m3u">ğŸ‡±ğŸ‡§ Ù„Ø¨Ù†Ø§Ù†</option>
            <option value="https://iptv-org.github.io/iptv/countries/ps.m3u">ğŸ‡µğŸ‡¸ ÙÙ„Ø³Ø·ÙŠÙ†</option>
            <option value="https://iptv-org.github.io/iptv/countries/om.m3u">ğŸ‡´ğŸ‡² Ø¹Ù…Ø§Ù†</option>
            <option value="https://iptv-org.github.io/iptv/countries/sa.m3u">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
            <option value="https://iptv-org.github.io/iptv/countries/sy.m3u">ğŸ‡¸ğŸ‡¾ Ø³ÙˆØ±ÙŠØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/ae.m3u">ğŸ‡¦ğŸ‡ª Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
            <option value="https://iptv-org.github.io/iptv/countries/in.m3u">ğŸ‡®ğŸ‡³ Ø§Ù„Ù‡Ù†Ø¯</option>
            <option value="https://iptv-org.github.io/iptv/countries/id.m3u">ğŸ‡®ğŸ‡© Ø¥Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠØ§</option>
        </optgroup>

        <optgroup label="Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ† (Ø£Ù‚Ø§Ù„ÙŠÙ… ÙˆÙ…Ø¯Ù†)">
            <option value="https://iptv-org.github.io/iptv/countries/ar.m3u">ğŸ‡¦ğŸ‡· Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ† (Ø§Ù„ÙƒÙ„)</option>
            <option value="https://iptv-org.github.io/iptv/subdivisions/ar-b.m3u">Buenos Aires ğŸ‡¦ğŸ‡·</option>
            <option value="https://iptv-org.github.io/iptv/cities/arbhi.m3u">BahÃ­a Blanca ğŸ‡¦ğŸ‡·</option>
            <option value="https://iptv-org.github.io/iptv/subdivisions/ar-x.m3u">Cordoba ğŸ‡¦ğŸ‡·</option>
            <option value="https://iptv-org.github.io/iptv/subdivisions/ar-s.m3u">Santa Fe ğŸ‡¦ğŸ‡·</option>
        </optgroup>

        <optgroup label="Ø£ÙˆØ±ÙˆØ¨Ø§ ÙˆØ£Ù…Ø±ÙŠÙƒØ§">
            <option value="https://iptv-org.github.io/iptv/countries/al.m3u">ğŸ‡¦ğŸ‡± Ø£Ù„Ø¨Ø§Ù†ÙŠØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/ad.m3u">ğŸ‡¦ğŸ‡© Ø£Ù†Ø¯ÙˆØ±Ø§</option>
            <option value="https://iptv-org.github.io/iptv/countries/at.m3u">ğŸ‡¦ğŸ‡¹ Ø§Ù„Ù†Ù…Ø³Ø§</option>
            <option value="https://iptv-org.github.io/iptv/countries/be.m3u">ğŸ‡§ğŸ‡ª Ø¨Ù„Ø¬ÙŠÙƒØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/fr.m3u">ğŸ‡«ğŸ‡· ÙØ±Ù†Ø³Ø§</option>
            <option value="https://iptv-org.github.io/iptv/countries/de.m3u">ğŸ‡©ğŸ‡ª Ø£Ù„Ù…Ø§Ù†ÙŠØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/it.m3u">ğŸ‡®ğŸ‡¹ Ø¥ÙŠØ·Ø§Ù„ÙŠØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/es.m3u">ğŸ‡ªğŸ‡¸ Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/us.m3u">ğŸ‡ºğŸ‡¸ Ø£Ù…Ø±ÙŠÙƒØ§</option>
            <option value="https://iptv-org.github.io/iptv/countries/ca.m3u">ğŸ‡¨ğŸ‡¦ ÙƒÙ†Ø¯Ø§</option>
            <option value="https://iptv-org.github.io/iptv/countries/br.m3u">ğŸ‡§ğŸ‡· Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„</option>
        </optgroup>
      </select>
    </div>

    <div style="display:flex;gap:8px;margin-bottom:8px">
      <input id="searchInput" class="input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ù†Ø§Ø©..." oninput="filterChannels()">
      <select id="groupFilter" class="input" onchange="filterChannels()">
        <option value="all">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
      </select>
    </div>

    <div class="list" id="listContainer"></div>
    <input type="file" id="importFile" accept=".m3u,.txt" style="display:none">
  </aside>

  <section style="display:flex;flex-direction:column;gap:12px">
    <div class="player-card">
      <div class="video-wrap">
        <video id="player" controls playsinline poster="https://wallpaperaccess.com/full/1567831.jpg"></video>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
        <div>
          <h2 id="viewName" style="color:var(--primary);margin:0">MisterAI Player</h2>
          <p id="viewGroup" class="small" style="margin:0; font-size: 0.8rem; color: var(--muted)">Ø§Ø®ØªØ± Ù‚Ù†Ø§Ø© Ù„Ù„Ø¨Ø¯Ø¡</p>
        </div>
        <div class="small" id="totalCount">Ø§Ù„Ù‚Ù†ÙˆØ§Øª: 0</div>
      </div>
    </div>
    <div class="small" style="padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px;">
        Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù†Ø´Ø·. ØªÙ… Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ØºÙŠØ± Ø§Ù„Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§.
    </div>
  </section>
</main>

<div class="footer">ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© <b style="color:var(--primary)">MUSTAPHA (MisterAI)</b> Â© 2025</div>

<script>
const STORAGE_KEY = 'MisterAI_channels_v5';
let allChannels = [];
const player = document.getElementById('player');

function toast(msg){ 
    const d=document.createElement('div'); 
    d.className='toast'; d.textContent=msg; 
    document.body.appendChild(d); 
    setTimeout(()=>d.remove(), 2500); 
}

function saveLocal(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(allChannels)); }
function loadLocal(){ const v = localStorage.getItem(STORAGE_KEY); return v ? JSON.parse(v) : []; }

window.addEventListener('load', ()=>{
  allChannels = loadLocal();
  renderList();
  updateGroups();
});

document.getElementById('importBtn').addEventListener('click', ()=>document.getElementById('importFile').click());
document.getElementById('importFile').addEventListener('change', async (ev)=>{
  const f = ev.target.files[0];
  if(f){ const txt = await f.text(); parseM3U(txt, true); toast('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù'); }
});

function parseM3U(text, append=false){
  const lines = text.split(/\r?\n/);
  const out = [];
  for(let i=0; i<lines.length; i++){
    if(lines[i].startsWith('#EXTINF:')){
      const name = (lines[i].split(',')[1] || 'Unknown').trim();
      const group = lines[i].match(/group-title="([^"]+)"/)?.[1] || 'Global';
      const logo = lines[i].match(/tvg-logo="([^"]+)"/)?.[1] || '';
      const url = lines[i+1]?.trim();
      if(url && url.startsWith('http')) out.push({name, group, logo, url, status:'unknown'});
    }
  }
  allChannels = append ? allChannels.concat(out) : out;
  saveLocal(); renderList(); updateGroups();
}

function renderList(filtered=null){
  const container = document.getElementById('listContainer');
  container.innerHTML = '';
  const data = filtered || allChannels;
  document.getElementById('totalCount').textContent = `Ø§Ù„Ù‚Ù†ÙˆØ§Øª: ${data.length}`;
  data.forEach((c, idx) => {
    const el = document.createElement('div'); el.className='channel';
    el.innerHTML = `
      <img src="${c.logo || 'https://cdn-icons-png.flaticon.com/512/716/716429.png'}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/716/716429.png'">
      <div class="meta"><b>${c.name}</b><small>${c.group}</small></div>
    `;
    el.onclick = ()=> playChannel(c);
    container.appendChild(el);
  });
}

function playChannel(c){
  document.getElementById('viewName').textContent = c.name;
  document.getElementById('viewGroup').textContent = c.group;
  if(Hls.isSupported() && (c.url.includes('m3u8') || c.url.includes('stream'))){
    const hls = new Hls(); hls.loadSource(c.url); hls.attachMedia(player);
    hls.on(Hls.Events.MANIFEST_PARSED, ()=>player.play().catch(e=>console.log("Auto-play blocked")));
  } else { player.src = c.url; player.play().catch(e=>console.log("Auto-play blocked")); }
}

function filterChannels(){
  const q = document.getElementById('searchInput').value.toLowerCase();
  const g = document.getElementById('groupFilter').value;
  const filtered = allChannels.filter(c => 
    (g === 'all' || c.group === g) && (c.name.toLowerCase().includes(q))
  );
  renderList(filtered);
}

function updateGroups(){
  const sel = document.getElementById('groupFilter');
  const groups = [...new Set(allChannels.map(c=>c.group))].sort();
  sel.innerHTML = '<option value="all">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>';
  groups.forEach(g => { const o = document.createElement('option'); o.value=o.textContent=g; sel.appendChild(o); });
}

document.getElementById('sourceSelector').addEventListener('change', async (e)=>{
  if(!e.target.value) return;
  document.getElementById('loadStatus').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
  try {
    const res = await fetch(e.target.value);
    const txt = await res.text();
    parseM3U(txt);
    document.getElementById('loadStatus').textContent = 'Ø¬Ø§Ù‡Ø²';
    toast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­');
  } catch(err) { 
    document.getElementById('loadStatus').textContent = 'Ø®Ø·Ø£';
    toast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ§Øª CORS)'); 
  }
});

document.getElementById('clearBtn').onclick = ()=>{ 
    if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§ØªØŸ')){ allChannels=[]; saveLocal(); renderList(); toast('ØªÙ… Ø§Ù„Ù…Ø³Ø­'); }
};
</script>

</body>
</html>
